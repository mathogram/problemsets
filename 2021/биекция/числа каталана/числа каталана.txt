< # Числа Каталана

*Рассмотрим алгебраическую задачу.* Пусть имеется $n + 1$ переменная $x_0$, $x_1$, $\ldots$, $x_n$, и мы хотим вычислить их произведение при помощи $n$ умножений. Определим число $C_n$ как количество способов расставить скобки в произведении 
$x_0 \cdot x_1 \cdot \ldots \cdot x_n$ так, чтобы порядок умножений был полностью определен.

$$\{C_n\} = \{C_0, C_1, C_2, \ldots \} = \{1, 1, 2, 5, 14, 42, \ldots \}$$

Например,
- Произведение $abc$ можно понимать двояко: $(ab)c$ и $a(bc)$.
- Произведение $abcd$ можно понимать пятью способами: $((ab)c)d$, $(a(bc))d$, $a((bc)d)$, $a(b(cd))$ и $(ab)(cd)$. 


**Пример 1 (Рекуррентное соотношение).**  Докажите, что числа Каталана удовлетворяют рекуррентному соотношению
$C_n = C_0C_{n-1} + C_1C_{n-2} + \ldots + C_{n-1}C_0$.

*Наводка.* Рассмотрите в произведении $x_0 \cdot x_1 \cdot \ldots \cdot x_n$ то умножение, которое делается последним. Например, осталось $A \cdot B$, что можно переписать как $(x_0 \cdot x_1 \cdot \ldots \cdot x_r)\cdot(x_{r+1} \cdot x_{r+2} \cdot \ldots \cdot x_n)$.


**Пример 2.** Сколько последовательностей $\{a_1, a_2, \ldots , a_{2n}\}$, состоящих из $+1$ и $-1$, обладают тем свойством, что $a_1 + a_2 + \ldots + a_{2n} = 0$, а все их частичные суммы $$a_1, ~a_1 + a_2, ~\ldots , ~a_1 + a_2 + \ldots + a_{2n}$$ неотрицательны?

*Наводка.* Можно сделать однозначное соответствие между такими последовательностями и расстановками скобок в произведении $x_0 \cdot x_1 \cdot \ldots \cdot x_n$ по одному из правил
$$\begin{array}{cc}
+1 &\longmapsto & ( \\
-1 &\longmapsto & \times
\end{array} 
\text{~  или  ~}
\begin{array}{cc}
+1 &\longmapsto & \times \\
-1 &\longmapsto & )
\end{array}$$


**Пример 3 (Определение Эйлера).** Сколько существует способов разрезать выпуклый $(n + 2)-$угольник диагоналями на треугольники?

*Наводка.* Обозначим все вершины как $A_0,A_1, ..., A_{n+1}$. Диагональ $A_0A_r$ разделит многоугольник на два меньших многоугольника. От сюда можно вывести рекуррентную формулу.


## Задачи для самостоятельного решения


Во многих комбинаторных задачах решением является последовательность чисел Каталана.
1. **Маршруты ладьи.** Рассмотрим шахматные доски со сторонами $2, ~3, ~4, ~\ldots$. Требуется провести ладью из левого нижнего угла
в правый верхний. Двигаться можно только вверх и вправо, не заходя
при этом на клетки главной диагонали и ниже нее. (Ладья оказывается на главной диагонали только в начальный и в конечный моменты
времени.) Сколько существует таких маршрутов?

1. **Очередь в кассу.** Билеты стоят 50 центов, и $2n$ покупателей
стоят в очереди в кассу. Половина из них имеет по одному доллару,
остальные — по 50 центов. Кассир начинает продажу билетов, не имея
денег. Сколько существует различных порядков в очереди, таких, что
кассир всегда может дать сдачу?

1. Пусть $\{a_1, a_2, \ldots , a_n\}$ — последовательность целых чисел, сумма которых равна $+1$. Докажите, что ровно у одного из ее циклических сдвигов
$$\{a_1, a_2, \ldots , a_n\}, ~\{a_2, \ldots , a_n, a_1\}, ~\ldots , ~\{a_n, a_1 \ldots , a_{n-1}\},$$
все частичные суммы положительны.

1. Докажите, что
$$C_n = C^n_{2n+1} \frac{1}{2n + 1} = C^n_{2n} \frac{1}{n + 1}$$