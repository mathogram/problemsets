< # Функция Эйлера

**Содержание**
~ [Полные и приведенные системы вычетов](#полные-и-приведенные-системы-вычетов)
~ [Малая теорема Ферма](#малая-теорема-ферма)
~ [Функция Эйлера](#функция-эйлера-1)
~ [Считаем $\varphi(n)$](#считаем-varphin)
~ [Задачи для самостоятельного решения](#задачи-для-самостоятельного-решения)


## Полные и приведенные системы вычетов

*Определение.* Числа $a_1,a_2,\dots,a_k$ образуют *полную систему вычетов* по модулю $m$, если любое целое число сравнимо по модулю $m$ с *одним и только одним* из этих чисел.

**Теорема 5.** Пусть $a_1,a_2,\ldots,a_m$ — полная система вычетов по модулю $m$. Пусть $x$ — целое число, взаимно простое с $m$. Тогда $xa_1,xa_2,\ldots,xa_m$ — тоже полная система вычетов по модулю $m$.
~ *Доказательство.*
От обратного. Допустим нашлись двое $xa_i$ и $xa_j$, которые дали одинаковый остаток, тогда
$$x(a_i - a_j) \mult{m}$$
по условию НОД$(x, m)=1$, поэтому
$$a_i \equiv a_j \mod{m},$$
но $a_1,a_2,\ldots,a_m$ — полная система вычетов по модулю $m$, то есть все дают разные остатки. Противоречие. Следовательно $xa_1,xa_2,\ldots,xa_m$ — тоже полная система вычетов по модулю $m$. $\square$

<br>


*Определение.* Числа $a_1,a_2,\ldots,a_k$ образуют *приведённую систему вычетов* по модулю $m$, если они взаимно просты с $m$ и любое целое число, взаимно простое с $m$, сравнимо с одним и только одним из этих чисел по модулю $m$.

**Теорема 6.** Пусть $a_1,a_2,\ldots,a_k$ — приведённая система вычетов по модулю $m$. Пусть $x$ — целое число, взаимно простое с $m$. Тогда $xa_1,xa_2,\ldots,xa_k$ — тоже приведённая система вычетов по модулю $m$.
~ *Доказательство.*
От обратного. Допустим нашлись двое $xa_i$ и $xa_j$, которые дали одинаковый остаток, тогда
$$x(a_i - a_j) \mult{m}$$
по условию НОД$(x, m)=1$, поэтому
$$a_i \equiv a_j \mod{m},$$
но по определению их остатки разные. Противоречие. Следовательно $xa_1,xa_2,\ldots,xa_k$ дают разные остатки по модулю $m$, но так как их количество $k$ (столько же сколько и всего враимопростых вычетов) значит это и есть приведенная система выченов. $\square$


## Малая теорема Ферма

**Теорема 7 (МТФ).** Пусть $p$ — простое число, тогда для любого натурального $n:(n, p)=1$  выполяется сравнение 
$$n^{p-1} \equiv 1 \mod{p}$$
~ *Доказательство.* Числа $n$, $2n$, $3n$, ..., $(p-1)n$ образуют приведённую систему вычетов по модулю $p$. Тогда
$$n\cdot 2n\cdot 3n\cdot \ldots \cdot(p-1)n \equiv 1\cdot 2\cdot 3\cdot \ldots \cdot(p-1) \mod{p}$$
Так как $(p-1)!$ взаимопрост с $p$ можно на него разделить
$$n^{p-1} \equiv 1 \mod{p}$$


## Функция Эйлера

*Определение.* Функция Эйлера $\varphi(n)$ — количество чисел от 1 до $n$, взаимно простых с $n$.

**Теорема 8 (Теорема Эйлера).** Если $x$ и $m$ — взаимно простые числа, то
$$x^{\varphi(m)}\equiv1 \pmod{m}.$$

~ *Доказательство.* Пусть числа $a_1	x$, $a_2 x$, $a_3 x$, ..., $a_k x$ образуют приведённую систему вычетов по модулю $m$. Тогда
$$a_1x\cdot a_2x\cdot a_3x\cdot \ldots \cdot a_kx \equiv a_1\cdot a_2\cdot a_3\cdot \ldots \cdot a_k \mod{m}$$
Так как $a_1$, $a_2$, $a_3$, $\ldots$, $a_k$ взаимопросты с $m$ на них можно разделить
$$x^{k} \equiv 1 \mod{m}.$$
Остатки $a_1$, $a_2$, $a_3$, $\ldots$, $a_k$ это все те, которые взаимопростые с $m$, по определению их $\varphi(m)$. Поэтому 
$$x^{\varphi(m)} \equiv 1 \mod{m}.$$


Сравнение сравнением, а как посчитать $\varphi(n)$? Вручную???

### Считаем $\varphi(n)$

Cледующих простых свойств функции Эйлера — достаточно, чтобы научиться вычислять её для любых чисел:

- Если $p$ — простое число, то $\varphi(p) = p-1$.
(Это очевидно, т.к. любое число, кроме самого $p$, взаимно просто с ним.)

- Если $p$ — простое, $a$ — натуральное число, то $\varphi (p^a)=p^a-p^{a-1}$.
(Поскольку с числом $p^a$ не взаимно просты только числа вида $pk$ ($k \in \N$), которых $p^a / p = p^{a-1}$ штук.)

- Если $a$ и $b$ взаимно простые, то $\varphi(ab) = \varphi(a) \varphi(b)$ (*«мультипликативность»* функции Эйлера).

	(Запишем все остатки по mod *ab* в таблицу. 
  
$$\begin{array}{ccccc}
1  & 2 & 3 & \dots & b \\
b+1  & b+2 & b+3 & \dots  & 2b\\
2b+1  & 2b+2 & 2b+3 & \dots  & 3b\\
3b+1  & 3b+2 & 3b+3 & \dots  & 4b\\
\dots & \dots & \dots & & \dots\\
(a-1)b+1  & (a-1)b+2 & (a-1)b+3 & \dots  & ab\\
\end{array}$$

  В каждой строке ровно $\varphi(b)$ взаимопростых с $ab$ чисел и в каждом столбце ровно $\varphi(a)$ взаимопростых с $ab$ чисел.)

Отсюда можно получить функцию Эйлера для любого $n$ через его факторизацию:
$$n = p_1^{a_1} \cdot p_2^{a_2} \cdot \ldots \cdot p_k^{a_k}$$
(где все $p_i$ — простые), то
$$\varphi(n) = \varphi(p_1^{a_1}) \cdot \varphi(p_2^{a_2})\cdot \ldots \cdot \varphi(p_2^{a_2})= \\
 = (p_1^{a_1} - p_1^{a_1-1}) \cdot (p_2^{a_2} - p_2^{a_2-1}) \cdot \ldots \cdot (p_k^{a_k} - p_k^{a_k-1}) = \\
 = n \cdot \left( 1-{1\over p_1} \right) \cdot \left( 1-{1\over p_2} \right) \cdot \ldots \cdot \left( 1-{1\over p_k} \right)$$


<br>

**Пример 1.**  Найдите остаток от деления числа $5^{11234}$ на $666$.

**Пример 2.** Известно, что $a^{12} + b^{12} + c^{12} + d^{12} + e^{12} + f^{12} \mult 13$. Докажите, что $abcdef \mult 13^6$.

## Задачи для самостоятельного решения

1. Пусть $n$ – натуральное число. Докажите, что существует натуральное число состоящее только из нулей и ровно $n$ единиц, делящееся на $n$.

1. Докажите, что если $n > 2$, то число всех правильных несократимых дробей со знаменателем $n$ — четно.
1. Докажите, что $\varphi(a)\varphi(b)=\varphi((a,b))\varphi([a,b])$.
1. Найдите все пятерки простых чисел $(q_1,q_2,q_3,q_4,q_5 )$, для которых число $q_1^4+q_2^4+q_3^4+q_4^4+q_5^4$ равно произведению двух последовательных четных натуральных чисел.
1. Найдите все тройки попарно взаимно простых натуральных чисел $(a,b,c)$ такие, что для каждого натурального $n$ число 
${{\left( {{a}^{n}}+{{b}^{n}}+{{c}^{n}} \right)}^{2}}$ делится на $ab+bc+ca$. 
1. Натуральное число $a$ и простое $p$ таковы, что НОД$(a,p!)=1$. Докажите, что  ${{a}^{(p-1)!}}-1$ делится на $p!$.

1. Докажите, что для любого натурального числа $n$ верно
$$n = \sum_{d | n}\varphi(d).$$






< <img width="300" src="https://preview.redd.it/omuw3c4hgt131.jpg?width=960&crop=smart&auto=webp&s=82fa4b3224a3eac312db5c042e5fb136316b587b">